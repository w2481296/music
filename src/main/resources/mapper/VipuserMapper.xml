<?xml version="1.0" encoding="UTF-8"?> 
	<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" 
		"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="cn.tedu.store.mapper.VipuserMapper">
	<select id="selectVipInfo" resultType="java.util.Map" parameterType="java.lang.String"
	useCache="false" flushCache="true">
		select
			id as id,
			vip_name as vipName,
			vip_gender as vipGender,
			vip_age as vipAge,
			vip_phone as vipPhone,
			vip_integral as vipIntegral,
		date_format(vip_createtime,'%Y-%c-%d %H:%i:%S') AS vipCreatetime,
		date_format(vip_updatetime,'%Y-%c-%d %H:%i:%S') AS vipUpdatetime
		from
			w_vip
		<where> 1=1
			<if test="vipName!=null and vipName!=''">
				AND vip_name like CONCAT('%',#{vipName},'%')
			</if>
			<if test="vipTime1!=null and vipTime1!=''">
				AND DATE_FORMAT(vip_createtime ,'%Y-%c-%d')&gt;=#{vipTime1}
			</if>
			<if test="vipTime2!=null and vipTime2!=''">
				AND DATE_FORMAT(vip_createtime ,'%Y-%c-%d')&lt;=#{vipTime2}
			</if>
		</where>
		group by id
	</select>
	<!-- 查询登录日志 -->
	<select id="querylogin" resultType="java.util.Map" parameterType="java.lang.String"
	useCache="false" flushCache="true">
		select
			id as id,
			username as username,
			userip as userip,
			city as city,
			remake as remake,
			date_format(logintime,'%Y-%c-%d %H:%i:%S') AS logintime
		from
			w_logininfo
		<where> 1=1
			<if test="vipName!=null and vipName!=''">
				AND username like CONCAT('%',#{vipName},'%')
			</if>
			<if test="vipTime1!=null and vipTime1!=''">
				AND DATE_FORMAT(logintime ,'%Y-%c-%d')&gt;=#{vipTime1}
			</if>
			<if test="vipTime2!=null and vipTime2!=''">
				AND DATE_FORMAT(logintime ,'%Y-%c-%d')&lt;=#{vipTime2}
			</if>
		</where>
		group by id
	</select>
	
	<!-- 删除会员 -->  
	<delete id="delMainInsById" parameterType="cn.tedu.store.bean.vipuser">  
		delete from w_vip  where id= #{vipid2}
	</delete> 
	<!-- 批量删除 -->
	<delete id="delvipsByIds"  parameterType="java.util.List">
         delete from w_vip where id in ( 
         <foreach collection="ids2" item="id" separator=",">
            #{id}
        </foreach>)
	</delete>
	<insert parameterType="cn.tedu.store.bean.vipuser" id="addvipinfo">
		insert into
		w_vip
		(vip_name,vip_gender,vip_age,vip_phone,vip_updatetime)
		values(#{vipName},#{vipGender},#{vipAge},#{vipPhone},now())
	</insert>
	
	<select id="queryvipById" resultType="java.util.Map" parameterType="java.lang.Integer"
	useCache="false" flushCache="true">
		select
			id as id,
			vip_name as vipName,
			vip_gender as vipGender,
			vip_age as vipAge,
			vip_phone as vipPhone,
			vip_integral as vipIntegral,
			date_format(vip_createtime,'%Y-%c-%d %H:%i:%S') AS vipCreatetime,
			date_format(vip_updatetime,'%Y-%c-%d %H:%i:%S') AS vipUpdatetime
		from
			w_vip
		where
			id=#{ids2}
	</select>
	<update id="updatevipinfo" parameterType="cn.tedu.store.bean.vipuser">
		update
			w_vip
		<set>
				vip_name =#{vipName},
				vip_gender=#{vipGender},
			<if test="vipAge!=null||vipAge!=''">
				vip_age =#{vipAge},
			</if>
			<if test="vipPhone!=null||vipPhone!=''">
				vip_phone =#{vipPhone},
			</if>			
			<if test="vipIntegral!=null||vipIntegral!=''">
				vip_integral =#{vipIntegral},
			</if>
				vip_updatetime=now()
		</set>
		where
			id=#{id}
	</update>
	
	
	
	
	
	<select id="selectUserInfo" resultType="java.util.Map" parameterType="java.lang.String"
	useCache="false" flushCache="true">
		select
			id as id,
			u_username as userName,
			u_password as userPassword,
			u_email as userEmail,
			u_phone as userPhone,
		date_format(u_updatetime,'%Y-%c-%d %H:%i:%S') AS userUpdatetime
		from
			w_user
		<where> 1=1
			<if test="vipName!=null and vipName!=''">
				AND u_username like CONCAT('%',#{vipName},'%')
			</if>
			<if test="vipTime1!=null and vipTime1!=''">
				AND DATE_FORMAT(u_updatetime ,'%Y-%c-%d')&gt;=#{vipTime1}
			</if>
			<if test="vipTime2!=null and vipTime2!=''">
				AND DATE_FORMAT(u_updatetime ,'%Y-%c-%d')&lt;=#{vipTime2}
			</if>
		</where>
		group by id
	</select>
	<!-- 删除用户-->  
	<delete id="delMainUserById" parameterType="cn.tedu.store.bean.User">  
		delete from w_user  where id= #{vipid2}
	</delete> 

	<!-- 批量删除 -->
	<delete id="delUsersByIds"  parameterType="java.util.List">
         delete from w_user where id in ( 
         <foreach collection="ids2" item="id" separator=",">
            #{id}
        </foreach>)
	</delete>
	<insert parameterType="cn.tedu.store.bean.User" id="addUserinfo">
		insert into
		w_user
		(u_username,u_password,u_email,u_phone,u_updatetime)
		values(#{username},#{password},#{email},#{phone},now())
	</insert>
</mapper>

		
	
	
	
	
	
	
	
	